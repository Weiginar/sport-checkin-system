import{_ as I,j as A,o as h,c as L,b as t,w as a,E as p,r,i,q as G,a as O,e as J,x as K,g as c,s as Q,v as W,t as X,y as Y,h as Z}from"./index-3HccLX9U.js";import{c as ee,d as te,e as le,f as ae}from"./index-B9m2kLEc.js";const oe={class:"sport-manage"},ne={class:"top-bar"},re={class:"pagination-wrap"},se={__name:"SportManage",setup(ie){const x=i([]),v=i(!1),k=i(0),_=i(1),b=i(10),d=i(!1),m=i(!1),y=i(!1),V=i(null),C=()=>({id:void 0,name:"",icon:"",caloriesPerHour:0,description:"",sortOrder:0,status:1}),o=Z(C()),P={name:[{required:!0,message:"请输入运动名称",trigger:"blur"}],caloriesPerHour:[{required:!0,message:"请输入每小时卡路里",trigger:"blur"}]},f=async()=>{v.value=!0;try{const e=(await ee({pageNum:_.value,pageSize:b.value})).data||{};x.value=e.records||[],k.value=e.total||0}catch{p.error("获取运动列表失败")}finally{v.value=!1}},S=()=>{Object.assign(o,C())},U=()=>{m.value=!1,S(),d.value=!0},D=n=>{m.value=!0,Object.assign(o,{id:n.id,name:n.name,icon:n.icon,caloriesPerHour:n.caloriesPerHour,description:n.description,sortOrder:n.sortOrder,status:n.status}),d.value=!0},H=async()=>{if(V.value){await V.value.validate(),y.value=!0;try{if(m.value)await le(o),p.success("更新成功");else{const{id:n,...e}=o;await ae(e),p.success("新增成功")}d.value=!1,f()}catch{p.error(m.value?"更新失败":"新增失败")}finally{y.value=!1}}},B=n=>{Y.confirm(`确定要删除运动项目「${n.name}」吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await te(n.id),p.success("删除成功"),f()}catch{p.error("删除失败")}}).catch(()=>{})};return A(()=>{f()}),(n,e)=>{const g=r("el-button"),s=r("el-table-column"),E=r("el-tag"),M=r("el-table"),N=r("el-pagination"),j=r("el-card"),w=r("el-input"),u=r("el-form-item"),z=r("el-input-number"),T=r("el-switch"),$=r("el-form"),q=r("el-dialog"),R=G("loading");return h(),L("div",oe,[t(j,{shadow:"never"},{default:a(()=>[O("div",ne,[t(g,{type:"primary",icon:J(K),onClick:U},{default:a(()=>[...e[10]||(e[10]=[c("新增运动项目",-1)])]),_:1},8,["icon"])]),Q((h(),W(M,{data:x.value,border:"",stripe:"",style:{width:"100%","margin-top":"16px"}},{default:a(()=>[t(s,{prop:"id",label:"ID",width:"70",align:"center"}),t(s,{prop:"name",label:"名称","min-width":"120"}),t(s,{prop:"icon",label:"图标",width:"80",align:"center"}),t(s,{prop:"caloriesPerHour",label:"每小时卡路里",width:"130",align:"center"}),t(s,{prop:"description",label:"描述","min-width":"180","show-overflow-tooltip":""}),t(s,{prop:"sortOrder",label:"排序",width:"70",align:"center"}),t(s,{label:"状态",width:"80",align:"center"},{default:a(({row:l})=>[t(E,{type:l.status===1?"success":"danger",size:"small"},{default:a(()=>[c(X(l.status===1?"启用":"禁用"),1)]),_:2},1032,["type"])]),_:1}),t(s,{prop:"createTime",label:"创建时间",width:"170"}),t(s,{label:"操作",width:"150",align:"center",fixed:"right"},{default:a(({row:l})=>[t(g,{type:"primary",link:"",size:"small",onClick:F=>D(l)},{default:a(()=>[...e[11]||(e[11]=[c("编辑",-1)])]),_:1},8,["onClick"]),t(g,{type:"danger",link:"",size:"small",onClick:F=>B(l)},{default:a(()=>[...e[12]||(e[12]=[c("删除",-1)])]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[R,v.value]]),O("div",re,[t(N,{"current-page":_.value,"onUpdate:currentPage":e[0]||(e[0]=l=>_.value=l),"page-size":b.value,"onUpdate:pageSize":e[1]||(e[1]=l=>b.value=l),total:k.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:f,onCurrentChange:f},null,8,["current-page","page-size","total"])])]),_:1}),t(q,{modelValue:d.value,"onUpdate:modelValue":e[9]||(e[9]=l=>d.value=l),title:m.value?"编辑运动项目":"新增运动项目",width:"520px","destroy-on-close":"",onClosed:S},{footer:a(()=>[t(g,{onClick:e[8]||(e[8]=l=>d.value=!1)},{default:a(()=>[...e[13]||(e[13]=[c("取消",-1)])]),_:1}),t(g,{type:"primary",loading:y.value,onClick:H},{default:a(()=>[...e[14]||(e[14]=[c("确定",-1)])]),_:1},8,["loading"])]),default:a(()=>[t($,{ref_key:"formRef",ref:V,model:o,rules:P,"label-width":"110px"},{default:a(()=>[t(u,{label:"运动名称",prop:"name"},{default:a(()=>[t(w,{modelValue:o.name,"onUpdate:modelValue":e[2]||(e[2]=l=>o.name=l),placeholder:"请输入运动名称"},null,8,["modelValue"])]),_:1}),t(u,{label:"图标标识",prop:"icon"},{default:a(()=>[t(w,{modelValue:o.icon,"onUpdate:modelValue":e[3]||(e[3]=l=>o.icon=l),placeholder:"请输入图标标识"},null,8,["modelValue"])]),_:1}),t(u,{label:"每小时卡路里",prop:"caloriesPerHour"},{default:a(()=>[t(z,{modelValue:o.caloriesPerHour,"onUpdate:modelValue":e[4]||(e[4]=l=>o.caloriesPerHour=l),min:0,precision:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(u,{label:"描述",prop:"description"},{default:a(()=>[t(w,{modelValue:o.description,"onUpdate:modelValue":e[5]||(e[5]=l=>o.description=l),type:"textarea",rows:3,placeholder:"请输入描述"},null,8,["modelValue"])]),_:1}),t(u,{label:"排序序号",prop:"sortOrder"},{default:a(()=>[t(z,{modelValue:o.sortOrder,"onUpdate:modelValue":e[6]||(e[6]=l=>o.sortOrder=l),min:0,precision:0,style:{width:"100%"}},null,8,["modelValue"])]),_:1}),t(u,{label:"状态",prop:"status"},{default:a(()=>[t(T,{modelValue:o.status,"onUpdate:modelValue":e[7]||(e[7]=l=>o.status=l),"active-value":1,"inactive-value":0,"active-text":"启用","inactive-text":"禁用"},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},pe=I(se,[["__scopeId","data-v-2d9877d9"]]);export{pe as default};
