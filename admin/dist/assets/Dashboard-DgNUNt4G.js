import{_ as L,j as z,k as B,o as D,c as O,b as e,w as s,h as U,r as _,i as m,a,t as p,e as v,f as A,m as E,n as N,p as V,g as h}from"./index-3HccLX9U.js";import{i as b,L as j}from"./index-Bn9PLWWT.js";import{g as G,a as P}from"./index-B9m2kLEc.js";const T={class:"dashboard"},I={class:"stat-content"},M={class:"stat-info"},W={class:"stat-number"},X={class:"stat-content"},q={class:"stat-info"},F={class:"stat-number"},H={class:"stat-content"},J={class:"stat-info"},K={class:"stat-number"},Q={class:"stat-content"},Y={class:"stat-info"},Z={class:"stat-number"},$={__name:"Dashboard",setup(tt){const f=U({totalUsers:0,todayCheckins:0,totalCheckins:0,activeUsers:0}),g=m(null),y=m(null),w=m(null);let n=null,i=null,d=null;const x=o=>{n=b(g.value),n.setOption({tooltip:{trigger:"axis"},xAxis:{type:"category",data:o.map(t=>t.date),axisLabel:{rotate:45}},yAxis:{type:"value",name:"打卡次数"},series:[{name:"打卡次数",type:"line",smooth:!0,data:o.map(t=>t.count),areaStyle:{color:"rgba(64,158,255,0.15)"},lineStyle:{color:"#409eff"},itemStyle:{color:"#409eff"}}],grid:{left:50,right:20,bottom:60,top:20}})},R=o=>{i=b(y.value),i.setOption({tooltip:{trigger:"item",formatter:"{b}: {c} ({d}%)"},legend:{orient:"vertical",left:"left",top:"middle"},series:[{type:"pie",radius:["40%","70%"],center:["60%","50%"],data:o.map(t=>({name:t.name,value:t.count})),emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0,0,0,0.2)"}},label:{formatter:`{b}
{d}%`}}]})},C=o=>{d=b(w.value),d.setOption({tooltip:{trigger:"axis"},xAxis:{type:"category",data:o.map(t=>t.date),axisLabel:{rotate:45}},yAxis:{type:"value",name:"新增用户"},series:[{name:"新增用户",type:"bar",data:o.map(t=>t.newUsers),itemStyle:{color:new j(0,0,0,1,[{offset:0,color:"#4facfe"},{offset:1,color:"#00f2fe"}])},barWidth:"50%"}],grid:{left:50,right:20,bottom:60,top:20}})},k=()=>{n==null||n.resize(),i==null||i.resize(),d==null||d.resize()};return z(async()=>{try{const[o,t]=await Promise.all([G(),P({days:30})]),c=o.data||o;Object.assign(f,c);const l=t.data||t,{dailyCheckins:r=[],sportDistribution:u=[],userGrowth:S=[]}=l;x(r),R(u),C(S),window.addEventListener("resize",k)}catch(o){console.error("加载统计数据失败",o)}}),B(()=>{window.removeEventListener("resize",k),n==null||n.dispose(),i==null||i.dispose(),d==null||d.dispose()}),(o,t)=>{const c=_("el-icon"),l=_("el-card"),r=_("el-col"),u=_("el-row");return D(),O("div",T,[e(u,{gutter:20,class:"stat-row"},{default:s(()=>[e(r,{span:6},{default:s(()=>[e(l,{shadow:"hover",class:"stat-card"},{default:s(()=>[a("div",I,[a("div",M,[a("div",W,p(f.totalUsers??0),1),t[0]||(t[0]=a("div",{class:"stat-label"},"总用户数",-1))]),e(c,{class:"stat-icon",style:{color:"#409eff",background:"rgba(64,158,255,0.1)"}},{default:s(()=>[e(v(A))]),_:1})])]),_:1})]),_:1}),e(r,{span:6},{default:s(()=>[e(l,{shadow:"hover",class:"stat-card"},{default:s(()=>[a("div",X,[a("div",q,[a("div",F,p(f.todayCheckins??0),1),t[1]||(t[1]=a("div",{class:"stat-label"},"今日打卡",-1))]),e(c,{class:"stat-icon",style:{color:"#67c23a",background:"rgba(103,194,58,0.1)"}},{default:s(()=>[e(v(E))]),_:1})])]),_:1})]),_:1}),e(r,{span:6},{default:s(()=>[e(l,{shadow:"hover",class:"stat-card"},{default:s(()=>[a("div",H,[a("div",J,[a("div",K,p(f.totalCheckins??0),1),t[2]||(t[2]=a("div",{class:"stat-label"},"总打卡次数",-1))]),e(c,{class:"stat-icon",style:{color:"#e6a23c",background:"rgba(230,162,60,0.1)"}},{default:s(()=>[e(v(N))]),_:1})])]),_:1})]),_:1}),e(r,{span:6},{default:s(()=>[e(l,{shadow:"hover",class:"stat-card"},{default:s(()=>[a("div",Q,[a("div",Y,[a("div",Z,p(f.activeUsers??0),1),t[3]||(t[3]=a("div",{class:"stat-label"},"活跃用户",-1))]),e(c,{class:"stat-icon",style:{color:"#a855f7",background:"rgba(168,85,247,0.1)"}},{default:s(()=>[e(v(V))]),_:1})])]),_:1})]),_:1})]),_:1}),e(u,{gutter:20,class:"chart-row"},{default:s(()=>[e(r,{span:16},{default:s(()=>[e(l,{shadow:"hover"},{header:s(()=>[...t[4]||(t[4]=[h("近30天打卡趋势",-1)])]),default:s(()=>[a("div",{ref_key:"lineChartRef",ref:g,class:"chart-container"},null,512)]),_:1})]),_:1}),e(r,{span:8},{default:s(()=>[e(l,{shadow:"hover"},{header:s(()=>[...t[5]||(t[5]=[h("运动类型分布",-1)])]),default:s(()=>[a("div",{ref_key:"pieChartRef",ref:y,class:"chart-container"},null,512)]),_:1})]),_:1})]),_:1}),e(u,{class:"chart-row"},{default:s(()=>[e(r,{span:24},{default:s(()=>[e(l,{shadow:"hover"},{header:s(()=>[...t[6]||(t[6]=[h("用户增长趋势",-1)])]),default:s(()=>[a("div",{ref_key:"barChartRef",ref:w,class:"chart-container"},null,512)]),_:1})]),_:1})]),_:1})])}}},ot=L($,[["__scopeId","data-v-a2fd85c3"]]);export{ot as default};
