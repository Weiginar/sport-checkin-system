<view class="page">
  <!-- Custom Header -->
  <view class="header">
    <view class="header-bg">
      <text class="header-title">è¿åŠ¨æ‰“å¡</text>
    </view>
  </view>

  <view class="body">
    <!-- Sport Selection - Horizontal Scroll -->
    <view class="card">
      <view class="card-title">é€‰æ‹©è¿åŠ¨ç±»å‹</view>
      <scroll-view class="sport-scroll" scroll-x enable-flex>
        <view
          class="sport-scroll-item {{selectedSport.id === item.id ? 'active' : ''}}"
          wx:for="{{sportList}}"
          wx:key="id"
          bindtap="selectSport"
          data-index="{{index}}"
        >
          <view class="scroll-icon">{{item.icon}}</view>
          <text class="scroll-name">{{item.name}}</text>
        </view>
      </scroll-view>
    </view>

    <!-- Data Input Card -->
    <view class="card">
      <view class="card-title">è¿åŠ¨æ•°æ®</view>

      <!-- Duration -->
      <view class="form-row">
        <text class="form-label">è¿åŠ¨æ—¶é•¿</text>
        <view class="form-value">
          <text class="duration-num">{{duration}}</text>
          <text class="form-unit">åˆ†é’Ÿ</text>
        </view>
      </view>
      <slider
        class="duration-slider"
        min="1"
        max="180"
        value="{{duration}}"
        activeColor="#f5af19"
        block-size="22"
        bindchanging="onDurationChange"
        bindchange="onDurationChange"
      />

      <!-- Distance (optional) -->
      <view class="form-row">
        <text class="form-label">è¿åŠ¨è·ç¦»ï¼ˆé€‰å¡«ï¼‰</text>
        <view class="form-input-wrap">
          <input
            class="form-input"
            type="digit"
            placeholder="0.00"
            value="{{distance}}"
            bindinput="onDistanceInput"
          />
          <text class="form-unit">å…¬é‡Œ</text>
        </view>
      </view>

      <!-- Calories -->
      <view class="form-row">
        <text class="form-label">æ¶ˆè€—çƒ­é‡</text>
        <view class="form-input-wrap">
          <input
            class="form-input"
            type="digit"
            placeholder="0"
            value="{{calories}}"
            bindinput="onCaloriesInput"
          />
          <text class="form-unit">åƒå¡</text>
        </view>
      </view>

      <!-- Remark -->
      <view class="form-row remark-row">
        <text class="form-label">å¤‡æ³¨ï¼ˆé€‰å¡«ï¼‰</text>
      </view>
      <textarea
        class="remark-input"
        placeholder="è®°å½•ä¸€ä¸‹ä»Šå¤©çš„è¿åŠ¨æ„Ÿå—å§~"
        maxlength="200"
        value="{{remark}}"
        bindinput="onRemarkInput"
      />
    </view>

    <!-- Submit Button -->
    <view
      class="btn-submit {{todayChecked ? 'disabled' : ''}}"
      bindtap="doCheckin"
    >
      {{todayChecked ? 'ä»Šæ—¥å·²æ‰“å¡' : 'æ‰“å¡'}}
    </view>
  </view>

  <!-- Success Popup -->
  <view class="modal-mask" wx:if="{{showSuccess}}" bindtap="closeSuccess">
    <view class="modal-content" catchtap>
      <view class="modal-icon">ğŸ‰</view>
      <text class="modal-title">æ‰“å¡æˆåŠŸ</text>
      <view class="modal-info">
        <view class="modal-row">
          <text class="modal-label">è·å¾—ç§¯åˆ†</text>
          <text class="modal-val">+{{checkinResult.points || 0}}</text>
        </view>
        <view class="modal-row">
          <text class="modal-label">è¿ç»­æ‰“å¡</text>
          <text class="modal-val">{{checkinResult.consecutiveDays || 0}}å¤©</text>
        </view>
        <view class="modal-row" wx:if="{{checkinResult.newAchievement}}">
          <text class="modal-label">æ–°æˆå°±</text>
          <text class="modal-val achievement">ğŸ† {{checkinResult.newAchievement}}</text>
        </view>
      </view>
      <view class="modal-btn" bindtap="closeSuccess">å¤ªæ£’äº†</view>
    </view>
  </view>
</view>
